<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8"><title>Discovery - TalkyGram</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { --ig-pink: #d62976; --ig-blue: #0095f6; }
        body { font-family: -apple-system, sans-serif; background: #fafafa; margin: 0; padding-bottom: 80px; }
        .nav { background: white; border-bottom: 1px solid #dbdbdb; padding: 10px 20px; display: flex; justify-content: space-between; sticky: top; position: sticky; top: 0; z-index: 100; }
        .card-container { max-width: 500px; margin: 20px auto; padding: 0 15px; }
        .profile-card { background: white; border: 1px solid #dbdbdb; border-radius: 12px; margin-bottom: 25px; overflow: hidden; }
        .profile-img { width: 100%; aspect-ratio: 1/1; object-fit: cover; }
        .profile-info { padding: 15px; }
        .tag { background: #efefef; padding: 5px 10px; border-radius: 15px; font-size: 12px; margin-right: 5px; }
        .btn-chat { background: var(--ig-blue); color: white; border: none; width: 100%; padding: 12px; font-weight: bold; cursor: pointer; }
        
        /* Modal de Pago */
        .paywall { position: fixed; inset: 0; background: rgba(0,0,0,0.8); display: none; align-items: center; justify-content: center; z-index: 1000; color: white; padding: 20px; }
        .pay-card { background: white; color: black; padding: 30px; border-radius: 15px; text-align: center; max-width: 400px; }
        .col-bank { background: #ffee00; padding: 10px; border-radius: 8px; margin: 10px 0; font-weight: bold; }
    </style>
</head>
<body>
    <div class="nav">
        <div style="font-weight: bold; font-size: 20px; color: var(--ig-pink);">TalkyGram</div>
        <div id="msg-counter">Mensajes libres: 5/5</div>
    </div>

    <div class="card-container" id="feed"></div>

    <div id="paywall" class="paywall">
        <div class="pay-card">
            <h2>ðŸ’Ž Acceso Ilimitado</h2>
            <p>Has agotado tus 5 mensajes gratuitos. Para continuar conociendo personas increÃ­bles, realiza una recarga.</p>
            <div class="col-bank">ðŸ“± NEQUI / DAVIPLATA: 300 000 0000</div>
            <div class="col-bank" style="background:#00448d; color:white;">Bancolombia: Ahorros 123-456789-01</div>
            <p style="font-size: 12px; color: #666;">EnvÃ­a el comprobante a soporte para activar tu plan VIP.</p>
            <button onclick="location.reload()" style="background:var(--ig-blue); color:white; border:none; padding:10px; width:100%; border-radius:5px;">Ya realicÃ© el pago</button>
        </div>
    </div>

    <script>
        let client = JSON.parse(localStorage.getItem('current_client')) || { name: "Usuario_"+Math.floor(Math.random()*1000), msgCount: 0, isVIP: false };
        
        const perfiles = [
            { name: "Valentina", age: 24, tags: ["Viajes", "Cine"], img: "https://i.pravatar.cc/500?u=val" },
            { name: "SebastiÃ¡n", age: 27, tags: ["Fitness", "MÃºsica"], img: "https://i.pravatar.cc/500?u=seb" }
        ];

        function renderFeed() {
            const feed = document.getElementById('feed');
            feed.innerHTML = perfiles.map(p => `
                <div class="profile-card">
                    <img src="${p.img}" class="profile-img">
                    <div class="profile-info">
                        <h3>${p.name}, ${p.age}</h3>
                        <div>${p.tags.map(t => `<span class="tag">${t}</span>`).join('')}</div>
                    </div>
                    <button class="btn-chat" onclick="openChat('${p.name}')">Enviar Mensaje</button>
                </div>
            `).join('');
        }

        function openChat(target) {
            if(client.msgCount >= 5 && !client.isVIP) {
                document.getElementById('paywall').style.display = 'flex';
                return;
            }
            const txt = prompt("Escribe tu mensaje para " + target);
            if(txt) {
                let msgs = JSON.parse(localStorage.getItem('db_messages') || '[]');
                msgs.push({ from: client.name, to: target, text: txt, date: new Date().getTime(), status: 'unread' });
                localStorage.setItem('db_messages', JSON.stringify(msgs));
                
                client.msgCount++;
                localStorage.setItem('current_client', JSON.stringify(client));
                updateCounter();
                alert("Mensaje enviado. Espera la respuesta...");
            }
        }

        function updateCounter() {
            document.getElementById('msg-counter').innerText = `Mensajes: ${5 - client.msgCount}/5`;
        }

        renderFeed();
        updateCounter();
    </script>
</body>
</html>